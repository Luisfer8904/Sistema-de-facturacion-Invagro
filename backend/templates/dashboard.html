{% extends "base.html" %}
{% block title %}Dashboard | Sistema de Facturacion Invagro{% endblock %}
{% block body_class %}page dashboard-page{% endblock %}
{% block content %}
  <div class="dashboard-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <img class="sidebar-logo" src="/static/assets/logo.jpg" alt="Invagro" />
        <h3>Invagro</h3>
      </div>
      <nav class="sidebar-nav">
        <a class="nav-item active" href="/dashboard"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 3l9 7.5M5.25 10.5V20.25h5.25V15h3v5.25h5.25V10.5"/></svg><span class="nav-text">Dashboard</span></a>
        <a class="nav-item" href="/facturacion"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m-6-8h6M6 4.5h12A1.5 1.5 0 0 1 19.5 6v12A1.5 1.5 0 0 1 18 19.5H6A1.5 1.5 0 0 1 4.5 18V6A1.5 1.5 0 0 1 6 4.5z"/></svg><span class="nav-text">Facturacion</span></a>
        <a class="nav-item" href="/pedidos"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.091.835L5.7 7.5m0 0H19.5l-1.35 6.75a1.125 1.125 0 0 1-1.102.9H7.35a1.125 1.125 0 0 1-1.102-.9L5.7 7.5zm0 0L4.5 4.5m3.75 12.75a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25zm9 0a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25"/></svg><span class="nav-text">Pedidos</span></a>
        <a class="nav-item" href="/facturas/credito"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75A2.25 2.25 0 0 1 4.5 4.5h15A2.25 2.25 0 0 1 21.75 6.75v10.5A2.25 2.25 0 0 1 19.5 19.5h-15A2.25 2.25 0 0 1 2.25 17.25V6.75zm0 1.5h19.5m-15 7.5h6"/></svg><span class="nav-text">Facturas credito</span></a>
        <a class="nav-item" href="/pagos"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12h19.5m-16.5 6h13.5m-15-12h15a2.25 2.25 0 0 1 2.25 2.25v7.5A2.25 2.25 0 0 1 18.75 18h-15A2.25 2.25 0 0 1 1.5 15.75v-7.5A2.25 2.25 0 0 1 3.75 6z"/></svg><span class="nav-text">Pagos</span></a>
        <a class="nav-item" href="/facturas/historial"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l4 2m6-2a10 10 0 1 1-4.293-8.293"/></svg><span class="nav-text">Historial facturas</span></a>
        <a class="nav-item" href="/clientes"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.06 9.06 0 0 0-6-2.22 9.06 9.06 0 0 0-6 2.22M15 9a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm7.5 3a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0z"/></svg><span class="nav-text">Clientes</span></a>
        <a class="nav-item" href="/productos"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25V16.5a2.25 2.25 0 0 1-1.125 1.95l-6.75 3.9a2.25 2.25 0 0 1-2.25 0l-6.75-3.9A2.25 2.25 0 0 1 3 16.5V8.25m18 0-8.25 4.764a2.25 2.25 0 0 1-2.25 0L3 8.25m18 0-8.25-4.764a2.25 2.25 0 0 0-2.25 0L3 8.25"/></svg><span class="nav-text">Productos</span></a>
        <a class="nav-item" href="/reportes"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M3 3v18h18M7.5 15.75v-6m4.5 6v-9m4.5 9v-4.5"/></svg><span class="nav-text">Reportes</span></a>
        <a class="nav-item" href="/ajustes"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94a1.5 1.5 0 0 1 2.812 0l.286.857a1.5 1.5 0 0 0 1.346 1.01h.902a1.5 1.5 0 0 1 1.06 2.56l-.655.655a1.5 1.5 0 0 0-.35 1.592l.286.857a1.5 1.5 0 0 1-1.42 1.987h-.902a1.5 1.5 0 0 0-1.346 1.01l-.286.857a1.5 1.5 0 0 1-2.812 0l-.286-.857a1.5 1.5 0 0 0-1.346-1.01h-.902a1.5 1.5 0 0 1-1.06-2.56l.655-.655a1.5 1.5 0 0 0 .35-1.592l-.286-.857a1.5 1.5 0 0 1 1.42-1.987h.902a1.5 1.5 0 0 0 1.346-1.01l.286-.857z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/></svg><span class="nav-text">Ajustes</span></a>
              <a class="nav-item" href="/logout"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15"/><path stroke-linecap="round" stroke-linejoin="round" d="M18 12H9m0 0 3-3m-3 3 3 3"/></svg><span class="nav-text">Cerrar sesion</span></a>
      </nav>
      <div class="sidebar-footer">
        <img class="sidebar-mascot" src="/static/assets/mascota.jpeg" alt="Mascota" />
      </div>
    </aside>

    <div class="main-content">
      <div class="topbar">
        <div class="topbar-left">
          <h2>Resumen</h2>
        </div>
        <div class="topbar-right">
          <span class="user-pill">Sesion: {{ user }}</span>
        </div>
      </div>

      <main class="content-area">
        <section class="welcome-card dashboard-hero">
          <div class="welcome-content">
            <h1>Bienvenido, {{ user }}</h1>
            <p>Tu panel de control esta listo para gestionar la facturacion y las ventas del dia.</p>
            <div class="hero-actions">
              <a class="primary-button" href="/facturacion">Nueva factura</a>
              <a class="secondary-button" href="/reportes">Ver reportes</a>
            </div>
          </div>
          <div class="welcome-metrics">
            <div class="metric">
              <span>Total pedidos</span>
              <strong>L {{ "{:,.2f}".format(pedidos_total or 0) }}</strong>
            </div>
            <div class="metric">
              <span>Credito pendiente</span>
              <strong>{{ "{:,}".format(facturas_credito_count or 0) }}</strong>
            </div>
          </div>
        </section>

        <section class="modules-grid">
          <article class="module-card">
            <h3>Clientes</h3>
            <p>Administra tu base de clientes y contactos.</p>
            <a class="module-link" href="/clientes">Entrar</a>
          </article>
          <article class="module-card">
            <h3>Facturacion</h3>
            <p>Genera comprobantes y controla estados.</p>
            <a class="module-link" href="/facturacion">Entrar</a>
          </article>
          <article class="module-card">
            <h3>Pedidos</h3>
            <p>Registra pedidos y cargalos luego a factura.</p>
            <a class="module-link" href="/pedidos">Entrar</a>
          </article>
          <article class="module-card">
            <h3>Productos</h3>
            <p>Catalogo de productos veterinarios y shampoo.</p>
            <a class="module-link" href="/productos">Entrar</a>
          </article>
          <article class="module-card">
            <h3>Reportes</h3>
            <p>Indicadores clave para decisiones.</p>
            <a class="module-link" href="/reportes">Entrar</a>
          </article>
        </section>

        <section class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Total pedidos</div>
            <div class="stat-value">L {{ "{:,.2f}".format(pedidos_total or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Credito pendiente</div>
            <div class="stat-value">{{ "{:,}".format(facturas_credito_count or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Total credito</div>
            <div class="stat-value">L {{ "{:,.2f}".format(credito_total or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Credito &lt; 30 dias</div>
            <div class="stat-value">L {{ "{:,.2f}".format(credito_menor_30 or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Credito &gt;= 30 dias</div>
            <div class="stat-value">L {{ "{:,.2f}".format(credito_mayor_30 or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Clientes</div>
            <div class="stat-value">{{ "{:,}".format(clientes_count or 0) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Productos</div>
            <div class="stat-value">{{ "{:,}".format(productos_count or 0) }}</div>
          </div>
        </section>
      </main>
    </div>
  </div>
{% endblock %}
